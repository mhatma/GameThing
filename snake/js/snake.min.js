var SNAKE=SNAKE||{};SNAKE.addEventListener=(function(){if(window.addEventListener){return function(d,c,b,a){d.addEventListener(c,b,a)}}else{if(window.attachEvent){return function(c,b,a){c.attachEvent("on"+b,a)}}}})();SNAKE.removeEventListener=(function(){if(window.removeEventListener){return function(d,c,b,a){d.removeEventListener(c,b,a)}}else{if(window.detachEvent){return function(c,b,a){c.detachEvent("on"+b,a)}}}})();SNAKE.Snake=SNAKE.Snake||(function(){var a=0;var b=[];var d=function(){this.elm=null;this.elmStyle=null;this.row=-1;this.col=-1;this.xPos=-1000;this.yPos=-1000;this.next=null;this.prev=null};function c(h){var g=0,e=0,f;for(f in h){if(h[f].elm.currentStyle){e=parseFloat(h[f].elm.style["z-index"],10)}else{if(window.getComputedStyle){e=parseFloat(document.defaultView.getComputedStyle(h[f].elm,null).getPropertyValue("z-index"),10)}}if(!isNaN(e)&&e>g){g=e}}return(g+1)}return function(g){if(!g||!g.playingBoard){return}var t=this,u=g.playingBoard,f=a++,i=5,q=[],s=1,h=[0,1,0,-1],k=[-1,0,1,0],e=[],n=[],r=75,j=false,p=false;function o(w,v){document.getElementById(w).addEventListener("click",function(){r=v})}o("Easy",100);o("Medium",75);o("Difficult",50);t.snakeBody={};t.snakeBody.b0=new d();t.snakeBody.b0.row=g.startRow||1;t.snakeBody.b0.col=g.startCol||1;t.snakeBody.b0.xPos=t.snakeBody.b0.row*u.getBlockWidth();t.snakeBody.b0.yPos=t.snakeBody.b0.col*u.getBlockHeight();t.snakeBody.b0.elm=m();t.snakeBody.b0.elmStyle=t.snakeBody.b0.elm.style;u.getBoardContainer().appendChild(t.snakeBody.b0.elm);t.snakeBody.b0.elm.style.left=t.snakeBody.b0.xPos+"px";t.snakeBody.b0.elm.style.top=t.snakeBody.b0.yPos+"px";t.snakeBody.b0.next=t.snakeBody.b0;t.snakeBody.b0.prev=t.snakeBody.b0;t.snakeLength=1;t.snakeHead=t.snakeBody.b0;t.snakeTail=t.snakeBody.b0;t.snakeHead.elm.className=t.snakeHead.elm.className.replace(/\bsnake-snakebody-dead\b/,"");t.snakeHead.elm.className+=" snake-snakebody-alive";function m(){var v=document.createElement("div");v.className="snake-snakebody-block";v.style.left="-1000px";v.style.top="-1000px";v.style.width=u.getBlockWidth()+"px";v.style.height=u.getBlockHeight()+"px";return v}function l(v){var y;var x=m();for(var w=1;w<v;w++){y=new d();y.elm=x.cloneNode(true);y.elmStyle=y.elm.style;u.getBoardContainer().appendChild(y.elm);b[b.length]=y}y=new d();y.elm=x;u.getBoardContainer().appendChild(y.elm);b[b.length]=y}t.setPaused=function(v){p=v};t.getPaused=function(){return p};t.handleArrowKeys=function(w){if(j||p){return}var x=t.snakeLength;var v=q[0]||s;switch(w){case 37:case 65:if(v!==1||x===1){q.unshift(3)}break;case 38:case 87:if(v!==2||x===1){q.unshift(0)}break;case 39:case 68:if(v!==3||x===1){q.unshift(1)}break;case 40:case 83:if(v!==0||x===1){q.unshift(2)}break}};t.go=function(){var x=t.snakeHead,v=t.snakeTail,y=s,w=u.grid;if(p===true){setTimeout(function(){t.go()},r);return}t.snakeTail=v.prev;t.snakeHead=v;if(w[v.row]&&w[v.row][v.col]){w[v.row][v.col]=0}if(q.length){y=s=q.pop()}v.col=x.col+h[y];v.row=x.row+k[y];v.xPos=x.xPos+e[y];v.yPos=x.yPos+n[y];if(!v.elmStyle){v.elmStyle=v.elm.style}v.elmStyle.left=v.xPos+"px";v.elmStyle.top=v.yPos+"px";if(w[v.row][v.col]===0){w[v.row][v.col]=1;setTimeout(function(){t.go()},r)}else{if(w[v.row][v.col]>0){t.handleDeath()}else{if(w[v.row][v.col]===u.getGridFoodValue()){w[v.row][v.col]=1;t.eatFood();setTimeout(function(){t.go()},r)}}}};t.eatFood=function(){if(b.length<=i){l(i*2)}var y=b.splice(0,i);var x=y.length,w,v=t.snakeTail;while(x--){w="b"+t.snakeLength++;t.snakeBody[w]=y[x];t.snakeBody[w].prev=v;t.snakeBody[w].elm.className=t.snakeHead.elm.className.replace(/\bsnake-snakebody-dead\b/,"");t.snakeBody[w].elm.className+=" snake-snakebody-alive";v.next=t.snakeBody[w];v=t.snakeBody[w]}t.snakeTail=t.snakeBody[w];t.snakeTail.next=t.snakeHead;t.snakeHead.prev=t.snakeTail;u.foodEaten()};t.handleDeath=function(){function v(){var w=localStorage.jsSnakeHighScore;if(w==undefined){localStorage.setItem("jsSnakeHighScore",t.snakeLength)}if(t.snakeLength>w){alert("Congratulations! You have beaten your previous high score, which was "+w+".");localStorage.setItem("jsSnakeHighScore",t.snakeLength);$("#thisPlayersHighScore").val(localStorage.jsSnakeHighScore);$("#thisPlayersHighScore").click()}}v();t.snakeHead.elm.style.zIndex=c(t.snakeBody);t.snakeHead.elm.className=t.snakeHead.elm.className.replace(/\bsnake-snakebody-alive\b/,"");t.snakeHead.elm.className+=" snake-snakebody-dead";j=true;u.handleDeath();q.length=0};t.rebirth=function(){j=false};t.reset=function(){if(j===false){return}var y=[],x=t.snakeHead.next,v;while(x!==t.snakeHead){v=x.next;x.prev=null;x.next=null;y.push(x);x=v}t.snakeHead.next=t.snakeHead;t.snakeHead.prev=t.snakeHead;t.snakeTail=t.snakeHead;t.snakeLength=1;for(var w=0;w<y.length;w++){y[w].elm.style.left="-1000px";y[w].elm.style.top="-1000px";y[w].elm.className=t.snakeHead.elm.className.replace(/\bsnake-snakebody-dead\b/,"");y[w].elm.className+=" snake-snakebody-alive"}b.concat(y);t.snakeHead.elm.className=t.snakeHead.elm.className.replace(/\bsnake-snakebody-dead\b/,"");t.snakeHead.elm.className+=" snake-snakebody-alive";t.snakeHead.row=g.startRow||1;t.snakeHead.col=g.startCol||1;t.snakeHead.xPos=t.snakeHead.row*u.getBlockWidth();t.snakeHead.yPos=t.snakeHead.col*u.getBlockHeight();t.snakeHead.elm.style.left=t.snakeHead.xPos+"px";t.snakeHead.elm.style.top=t.snakeHead.yPos+"px"};l(i*2);e[0]=0;e[1]=u.getBlockWidth();e[2]=0;e[3]=-1*u.getBlockWidth();n[0]=-1*u.getBlockHeight();n[1]=0;n[2]=u.getBlockHeight();n[3]=0}})();SNAKE.Food=SNAKE.Food||(function(){var b=0;function a(c,d){return Math.floor(Math.random()*(d+1-c))+c}return function(c){if(!c||!c.playingBoard){return}var g=this;var i=c.playingBoard;var h,f;var e=b++;var d=document.createElement("div");d.setAttribute("id","snake-food-"+e);d.className="snake-food-block";d.style.width=i.getBlockWidth()+"px";d.style.height=i.getBlockHeight()+"px";d.style.left="-1000px";d.style.top="-1000px";i.getBoardContainer().appendChild(d);g.getFoodElement=function(){return d};g.randomlyPlaceFood=function(){if(i.grid[h]&&i.grid[h][f]===i.getGridFoodValue()){i.grid[h][f]=0}var n=0,m=0,j=0;var k=i.grid.length-1;var l=i.grid[0].length-1;while(i.grid[n][m]!==0){n=a(1,k);m=a(1,l);j++;if(j>20000){n=-1;m=-1;break}}i.grid[n][m]=i.getGridFoodValue();h=n;f=m;d.style.top=n*i.getBlockHeight()+"px";d.style.left=m*i.getBlockWidth()+"px"}}})();SNAKE.Board=SNAKE.Board||(function(){var c=0;function d(h){var g=0,e=0,f;for(f in h){if(h[f].elm.currentStyle){e=parseFloat(h[f].elm.style["z-index"],10)}else{if(window.getComputedStyle){e=parseFloat(document.defaultView.getComputedStyle(h[f].elm,null).getPropertyValue("z-index"),10)}}if(!isNaN(e)&&e>g){g=e}}return(g+1)}function b(){var e=0;if(typeof window.innerWidth==="number"){e=window.innerWidth}else{if(document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)){e=document.documentElement.clientWidth}else{if(document.body&&(document.body.clientWidth||document.body.clientHeight)){e=document.body.clientWidth}}}return e}function a(){var e=0;if(typeof window.innerHeight==="number"){e=window.innerHeight}else{if(document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)){e=document.documentElement.clientHeight}else{if(document.body&&(document.body.clientWidth||document.body.clientHeight)){e=document.body.clientHeight}}}return e}return function(A){var D=this,B=c++,C=A||{},m=250,k=250,h=20,e=20,o=-1,n,z,w=1,l,i=false,x,v,j,g,u,r,s;D.grid=[];function t(){v=document.createElement("div");v.setAttribute("id","playingField");v.className="snake-playing-field";SNAKE.addEventListener(v,"click",function(){x.focus()},false);s=document.createElement("div");s.className="snake-pause-screen";s.innerHTML="<div style='padding:10px;'>[Paused]<p/>Press [space] to unpause.</div>";j=document.createElement("div");j.className="snake-panel-component";j.innerHTML="";g=document.createElement("div");g.className="snake-panel-component";g.innerHTML="Length: 1";u=p();r=y();SNAKE.addEventListener(x,"keyup",function(E){if(!E){var E=window.event}E.cancelBubble=true;if(E.stopPropagation){E.stopPropagation()}if(E.preventDefault){E.preventDefault()}return false},false);x.className="snake-game-container";s.style.zIndex=10000;x.appendChild(s);x.appendChild(v);x.appendChild(j);x.appendChild(g);x.appendChild(u);x.appendChild(r);z=new SNAKE.Snake({playingBoard:D,startRow:2,startCol:2});n=new SNAKE.Food({playingBoard:D});u.style.zIndex=1000}function q(){return m*D.getBlockWidth()}function f(){return k*D.getBlockHeight()}function p(){var G=document.createElement("div");G.id="sbWelcome"+B;G.className="snake-welcome-dialog";var F=document.createElement("div");var J="";if(C.fullScreen){}F.innerHTML="Snake<p></p>Press Enter to start.<br />Use the <strong>arrow keys</strong> on your keyboard to play. "+J+"<p></p>";var I=document.createElement("button");I.appendChild(document.createTextNode("Play Game"));var H=function(){SNAKE.removeEventListener(window,"keyup",E,false);G.style.display="none";D.setBoardState(1);D.getBoardContainer().focus()};var E=function(K){if(!K){var K=window.event}var L=(K.which)?K.which:K.keyCode;if(L===32||L===13){H()}};SNAKE.addEventListener(window,"keyup",E,false);SNAKE.addEventListener(I,"click",H,false);G.appendChild(F);G.appendChild(I);return G}function y(){var F=document.createElement("div");F.id="sbTryAgain"+B;F.className="snake-try-again-dialog";var G=document.createElement("div");G.innerHTML="JavaScript Snake<p></p>You died :(.<p></p>";var I=document.createElement("button");I.appendChild(document.createTextNode("Play Again?"));var H=function(){F.style.display="none";D.resetBoard();D.setBoardState(1);D.getBoardContainer().focus()};var E=function(J){if(w!==0||F.style.display!=="block"){return}if(!J){var J=window.event}var K=(J.which)?J.which:J.keyCode;if(K===32||K===13){H()}};SNAKE.addEventListener(window,"keyup",E,true);SNAKE.addEventListener(I,"click",H,false);F.appendChild(G);F.appendChild(I);return F}D.setPaused=function(E){i=E;z.setPaused(E);if(i){s.style.display="block"}else{s.style.display="none"}};D.getPaused=function(){return i};D.resetBoard=function(){SNAKE.removeEventListener(x,"keydown",l,false);z.reset();g.innerHTML="Length: 1";D.setupPlayingField()};D.getBoardState=function(){return w};D.setBoardState=function(E){w=E};D.getGridFoodValue=function(){return o};D.getPlayingFieldElement=function(){return v};D.setBoardContainer=function(E){if(typeof E==="string"){E=document.getElementById(E)}if(E===x){return}x=E;v=null;D.setupPlayingField()};D.getBoardContainer=function(){return x};D.getBlockWidth=function(){return h};D.getBlockHeight=function(){return e};D.setupPlayingField=function(){if(!v){t()}var L,P;if(C.fullScreen===true){cTop=0;cLeft=0;L=b()-5;P=a()-5;document.body.style.backgroundColor="#2b3343"}else{cTop=C.top;cLeft=C.left;L=C.width;P=C.height}var O=D.getBlockWidth()*2+(L%D.getBlockWidth());var G=Math.min(q()-O,L-O);var K=D.getBlockHeight()*3+(P%D.getBlockHeight());var M=Math.min(f()-K,P-K);x.style.left=cLeft+"px";x.style.top=cTop+"px";x.style.width=L+"px";x.style.height=P+"px";v.style.left=D.getBlockWidth()+"px";v.style.top=D.getBlockHeight()+"px";v.style.width=G+"px";v.style.height=M+"px";var I=K-D.getBlockHeight();var H=D.getBlockHeight()+M+Math.round((I-30)/2)+"px";j.style.top=H;j.style.width="450px";j.style.left=Math.round(L/2)-Math.round(450/2)+"px";g.style.top=H;g.style.left=L-120+"px";if(L<700){j.style.display="none"}else{j.style.display="block"}D.grid=[];var E=G/D.getBlockWidth()+2;var J=M/D.getBlockHeight()+2;for(var Q=0;Q<J;Q++){D.grid[Q]=[];for(var F=0;F<E;F++){if(F===0||Q===0||F===(E-1)||Q===(J-1)){D.grid[Q][F]=1}else{D.grid[Q][F]=0}}}n.randomlyPlaceFood();function N(S,R){document.getElementById(S).addEventListener("click",function(){snakeSpeed=R})}N("Easy",100);N("Medium",75);N("Difficult",50);l=function(R){if(!R){var R=window.event}var S=(R.which)?R.which:R.keyCode;if(D.getBoardState()===1){if(!(S>=37&&S<=40)&&!(S===87||S===65||S===83||S===68)){return}SNAKE.removeEventListener(x,"keydown",l,false);l=function(T){if(!T){var T=window.event}var U=(T.which)?T.which:T.keyCode;if(U===32){if(D.getBoardState()!=0){D.setPaused(!D.getPaused())}}z.handleArrowKeys(U);T.cancelBubble=true;if(T.stopPropagation){T.stopPropagation()}if(T.preventDefault){T.preventDefault()}return false};SNAKE.addEventListener(x,"keydown",l,false);z.rebirth();z.handleArrowKeys(S);D.setBoardState(2);z.go()}R.cancelBubble=true;if(R.stopPropagation){R.stopPropagation()}if(R.preventDefault){R.preventDefault()}return false};SNAKE.addEventListener(x,"keydown",l,false)};D.foodEaten=function(){g.innerHTML="Length: "+z.snakeLength;n.randomlyPlaceFood()};D.handleDeath=function(){var E=Math.max(d(z.snakeBody),d({tmp:{elm:n.getFoodElement()}}));x.removeChild(r);x.appendChild(r);r.style.zIndex=E;r.style.display="block";D.setBoardState(0)};C.fullScreen=(typeof C.fullScreen==="undefined")?false:C.fullScreen;C.top=(typeof C.top==="undefined")?0:C.top;C.left=(typeof C.left==="undefined")?0:C.left;C.width=(typeof C.width==="undefined")?400:C.width;C.height=(typeof C.height==="undefined")?400:C.height;if(C.fullScreen){SNAKE.addEventListener(window,"resize",function(){D.setupPlayingField()},false)}D.setBoardState(0);if(C.boardContainer){D.setBoardContainer(C.boardContainer)}}})();function getHighScore(){document.getElementById("high-score").addEventListener("click",function(){if(localStorage.jsSnakeHighScore==undefined){alert("You have not played this game yet!")}else{alert("Your current high score is "+localStorage.jsSnakeHighScore+".")}})}getHighScore();